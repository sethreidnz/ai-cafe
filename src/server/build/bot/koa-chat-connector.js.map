{"version":3,"sources":["../../src/bot/koa-chat-connector.js"],"names":["ChatConnector","Middleware","KoaChatConnector","listen","_listen","ctx","next","request","body","Error","Promise","req","res","send","status","code","end","resolve"],"mappings":";;AAAA,SAASA,aAAT,QAA8B,YAA9B;AACA,SAASC,UAAT,QAA2B,KAA3B;;AAEA,OAAO,MAAMC,gBAAN,SAA+BF,aAA/B,CAA6C;AAChDG,aAAS;AACL,cAAMC,UAAU,MAAMD,MAAN,EAAhB;;AAEA;AAAA,yCAAO,WAAOE,GAAP,EAAYC,IAAZ,EAAqB;AACxB,oBAAI,CAAED,IAAIE,OAAL,CAAcC,IAAnB,EAAyB;AACrB,0BAAM,IAAIC,KAAJ,CAAU,mGAAV,CAAN;AACH;;AAED,sBAAM,IAAIC,OAAJ,CAAY,mBAAW;AACzB,0BAAMC,MAAMN,IAAIE,OAAhB;AACA,0BAAMK,MAAM;AACRC,6BAAKC,MAAL,EAAaN,IAAb,EAAmB;AACfH,gCAAIS,MAAJ,GAAaA,MAAb;AACAT,gCAAIG,IAAJ,GAAWA,IAAX;AACH,yBAJO;AAKRM,+BAAOC,IAAP,EAAa;AACTV,gCAAIS,MAAJ,GAAaC,IAAb;AACH,yBAPO;AAQRC,8BAAM;AACFC;AACH;AAVO,qBAAZ;;AAaAb,4BAAQO,GAAR,EAAaC,GAAb;AACH,iBAhBK,CAAN;;AAkBA,sBAAMN,MAAN;AACH,aAxBD;;AAAA;AAAA;AAAA;AAAA;AAyBH;;AA7B+C","file":"koa-chat-connector.js","sourcesContent":["import { ChatConnector } from 'botbuilder';\r\nimport { Middleware } from 'koa';\r\n\r\nexport class KoaChatConnector extends ChatConnector {\r\n    listen() {\r\n        const _listen = super.listen();\r\n\r\n        return async (ctx, next) => {\r\n            if (!(ctx.request).body) {\r\n                throw new Error(\"Request body is missing. Please make sure you have a body parsing middleware properly configured.\");\r\n            }\r\n\r\n            await new Promise(resolve => {\r\n                const req = ctx.request;\r\n                const res = {\r\n                    send(status, body) {\r\n                        ctx.status = status;\r\n                        ctx.body = body;\r\n                    },\r\n                    status(code) {\r\n                        ctx.status = code;\r\n                    },\r\n                    end() {\r\n                        resolve();\r\n                    }\r\n                };\r\n\r\n                _listen(req, res);\r\n            })\r\n            \r\n            await next();\r\n        };\r\n    }\r\n\r\n}"]}